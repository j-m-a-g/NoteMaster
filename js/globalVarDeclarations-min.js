const additionalVideoControls=document.getElementById("additionalVideoControls"),appSectionSizesContainer=document.getElementById("appSectionSizesContainer"),characterCountVisualMax=document.getElementById("characterCountVisualMax"),codeFileViewerStatusBar=document.getElementById("codeFileViewerStatusBar"),convertWordToNoteInput=document.getElementById("convertWordToNoteInput"),customStylesheetImport=document.getElementById("customStylesheetImport"),downloadNotePrefixAndSuffix=["<div style='word-wrap: break-word'>",
"</div><style>body { font-family: sans-serif } td { word-break: break-word } h1, h2, h3, h4, h5, h6 { font-weight: normal } .ql-font-serif { font-family: serif } .ql-font-monospace { font-family: monospace }</style>"],gettingStartedDarkMode=document.getElementById("gettingStartedDarkMode"),insertOnlineImageInput=document.getElementById("insertOnlineImageInput"),programmingLanguageMode=document.getElementById("programmingLanguageMode"),startFromScratchOptions=document.getElementById("startFromScratchOptions"),
symbolList=[["\u00a1","Inverted Exclamation Mark"],["\u00a2","Cent"],["\u00a3","Pound"],["\u00a4","Currency"],["\u00a5","Yen"],["\u00a6","Broken Bar"],["\u00a7","Section"],["\u00a8","Diaeresis"],["\u00a9","Copyright"],["\u00ab","Left Double Angle Quotation Mark"],["\u00ac","Not"],["\u00ae","Registered"],["\u00af","Macron"],["\u00b0","Degree"],["\u00b1","Plus-Minus"],["\u00b2","Squared"],["\u00b3","Cubed"],["\u00b4","Acute"],["\u00b5","Micro"],["\u00b6","Pilcrow"],["\u00b7","Middle Dot"],["\u00b8",
"Cedilla"],["\u00b9","Superscript One"],["\u00ba","Masculine Ordinal Indicator"],["\u00bb","Right Double Angle Quotation Mark"],["\u00bc","One Quarter"],["\u00bd","One Half"],["\u00be","Three Quarters"],["\u00bf","Inverted Question Mark"],["\u00c0","Latin Uppercase A With Grave"],["\u00c1","Latin Uppercase A With Acute"],["\u00c2","Latin Uppercase A With Circumflex"],["\u00c3","Latin Uppercase A With Tilde"],["\u00c3","Latin Uppercase A With Tilde"],["\u00c3","Latin Uppercase A With Diaeresis"],["\u00c5",
"Latin Uppercase A With Ring"],["\u00c6","Latin Uppercase AE"],["\u00c7","Latin Uppercase C With Cedilla"],["\u00c8","Latin Uppercase E With Grave"],["\u00c9","Latin Uppercase E With Acute"],["\u00ca","Latin Uppercase E With Circumflex"],["\u00ca","Latin Uppercase E With Circumflex"],["\u00cb","Latin Uppercase E With Diaeresis"],["\u00cc","Latin Uppercase I With Grave"],["\u00cd","Latin Uppercase I With Acute"],["\u00cd","Latin Uppercase I With Acute"],["\u00ce","Latin Uppercase I With Circumflex"],
["\u00ce","Latin Uppercase I With Circumflex"],["\u00cf","Latin Uppercase I With Diaeresis"],["\u00d0","Latin Uppercase Eth"],["\u00d1","Latin Uppercase N With Tilde"],["\u00d2","Latin Uppercase O With Grave"],["\u00d3","Latin Uppercase O With Acute"],["\u00d4","Latin Uppercase O With Circumflex"],["\u00d5","Latin Uppercase O With Tilde"],["\u00d6","Latin Uppercase O With Diaeresis"],["\u00d7","Multiplication"],["\u00d8","Latin Uppercase O With Stroke"],["\u00d9","Latin Uppercase U With Grave"],["\u00da",
"Latin Uppercase U With Acute"],["\u00db","Latin Uppercase U With Circumflex"],["\u00dc","Latin Uppercase U With Diaeresis"],["\u00dd","Latin Uppercase Y With Acute"],["\u00de","Latin Uppercase Thom"],["\u00df","Latin Lowercase Sharp S"],["\u00e0","Latin Lowercase A With Grave"],["\u00e1","Latin Lowercase A With Acute"],["\u00e2","Latin Lowercase A With Circumflex"],["\u00e3","Latin Lowercase A With Tilde"],["\u00e4","Latin Lowercase A With Diaeresis"],["\u00e5","Latin Lowercase A With Ring"],["\u00e6",
"Latin Lowercase AE"],["\u00e7","Latin Lowercase C With Cedilla"],["\u00e8","Latin Lowercase E With Grave"],["\u00e9","Latin Lowercase E With Acute"],["\u00ea","Latin Lowercase E With Circumflex"],["\u00eb","Latin Lowercase E With Diaeresis"],["\u00ec","Latin Lowercase I With Grave"],["\u00ed","Latin Lowercase I With Acute"],["\u00ee","Latin Lowercase I With Circumflex"],["\u00ef","Latin Lowercase I With Diaeresis"],["\u00f0","Latin Lowercase Eth"],["\u00f1","Latin Lowercase N With Tilde"],["\u00f2",
"Latin Lowercase O With Grave"],["\u00f3","Latin Lowercase O With Acute"],["\u00f4","Latin Lowercase O With Circumflex"],["\u00f5","Latin Lowercase O With Tilde"],["\u00f6","Latin Lowercase O With Diaeresis"],["\u00f7","Division"],["\u00f8","Latin Lowercase O With Stroke"],["\u00f9","Latin Lowercase U With Grave"],["\u00fa","Latin Lowercase U With Acute"],["\u00fb","Latin Lowercase U With Circumflex"],["\u00fc","Latin Lowercase U With Diaeresis"],["\u00fd","Latin Lowercase Y With Acute"],["\u00fe",
"Latin Lowercase Thom"],["\u00ff","Latin Lowercase Y With Diaeresis"],["\u0100","Latin Uppercase A With Macron"],["\u0101","Latin Lowercase A With Macron"],["\u0102","Latin Uppercase A With Breve"],["\u0103","Latin Lowercase A With Breve"],["\u0104","Latin Uppercase A With Ogonek"],["\u0105","Latin Lowercase A With Ogonek"],["\u0106","Latin Uppercase C With Acute"],["\u0107","Latin Lowercase C With Acute"],["\u0108","Latin Uppercase C With Circumflex"],["\u0109","Latin Lowercase C With Circumflex"],
["\u010a","Latin Uppercase C With Dot"],["\u010b","Latin Lowercase C With Dot"],["\u010c","Latin Uppercase C With Caron"],["\u010d","Latin Lowercase C With Caron"],["\u010f","Latin Lowercase D With Caron"]],totalCharacterCountDisplay=document.getElementById("totalCharacterCountDisplay"),viewerStatusBarIndicator=document.getElementById("viewerStatusBarIndicator"),wordDocumentToNoteButton=document.getElementById("wordDocumentToNoteButton"),adjustAppSectionSizes=document.getElementById("adjustAppSectionSizes"),
adjustedHeight=`${window.innerHeight-35}px`,anotherNoteFileInput=document.getElementById("anotherNoteFileInput"),anotherNoteView=document.getElementById("anotherNoteView"),anotherNoteViewer=document.getElementById("anotherNoteViewer"),appLoad=document.getElementById("appLoad"),appName="NoteMaster",appSectionsTable=document.getElementById("appSectionsTable"),autoSave=document.getElementById("autoSave"),autoSaveCheck=document.getElementById("autoSaveCheck"),characterCount=document.getElementById("characterCount"),
characterCountVisual=document.getElementById("characterCountVisual"),checkedImageSource="assets/images/check_000000.svg",chooseViewer=document.getElementById("chooseViewer"),closeFile=document.getElementById("closeFile"),cloudFileView=document.getElementById("cloudFileView"),cloudFileViewer=document.getElementById("cloudFileViewer"),codeEditorTheme=document.getElementById("codeEditorTheme"),codeFileInput=document.getElementById("codeFileInput"),codeFileView=document.getElementById("codeFileView"),
codeFileViewer=document.getElementById("codeFileViewer"),confirmSaveDialog=document.getElementById("confirmSaveDialog"),confirmViewerClose=document.getElementById("confirmViewerClose"),copiedToClipboard=document.getElementById("copiedToClipboard"),copiedToClipboardString="Copied to clipboard",createdTable=document.getElementById("createdTable"),createOrOpenContainer=document.getElementById("createOrOpenContainer"),currentDate=new Date,customEmbedViewer=document.getElementById("customEmbedViewer"),
customStylesheet=document.getElementById("customStylesheet"),customTypingTarget=document.getElementById("customTypingTarget"),darkModeCheck=document.getElementById("darkModeCheck"),darkModeStylesheet=document.getElementById("darkModeStylesheet"),darkModeToggle=document.getElementById("darkModeToggle"),dialogFocusBackground=document.getElementById("dialogFocusBackground"),downloadConvertedNote=document.getElementById("downloadConvertedNote"),editorSize=document.getElementById("editorSize"),embeddedCode=
document.getElementById("embeddedCode"),errorMessage=document.getElementById("errorMessage"),fileLastModified=document.getElementById("fileLastModified"),fileName=document.getElementById("fileName"),fileSize=document.getElementById("fileSize"),fileViewingHistoryNames=[],fileViewingHistoryTimes=[],hideEditorCheck=document.getElementById("hideEditorCheck"),hideViewingCheck=document.getElementById("hideViewingCheck"),historyTableContainer=document.getElementById("historyTableContainer"),iframes=document.getElementsByTagName("iframe"),
imageFileInput=document.getElementById("imageFileInput"),imageView=document.getElementById("imageView"),imageViewer=document.getElementById("imageViewer"),importOwnStylesheet=document.getElementById("importOwnStylesheet"),insertCloudURLDialog=document.getElementById("insertCloudURLDialog"),insertOnlineImage=document.getElementById("insertOnlineImage"),insertSymbol=document.getElementById("insertSymbol"),insertTable=document.getElementById("insertTable"),lastViewedWebpages=[],localDocuments=document.getElementById("localDocuments"),
mainEditor=document.getElementById("mainEditor"),mainEditorZoom=document.getElementById("mainEditorZoom"),markdownFileInput=document.getElementById("markdownFileInput"),markdownFileView=document.getElementById("markdownFileView"),noFileSelected=document.getElementById("noFileSelected"),noteDownloadLink=document.getElementById("noteDownloadLink"),noteEditor=document.getElementById("noteEditor"),noteHTML=document.getElementById("noteHTML"),noteName=document.getElementById("noteName"),onedriveOrigin=
document.getElementById("onedriveOrigin"),onlineDesignView=document.getElementById("onlineDesignView"),onlineDesignViewer=document.getElementById("onlineDesignViewer"),onlineDocuments=document.getElementById("onlineDocuments"),openNoteFileInput=document.getElementById("openNoteFileInput"),originalDownloadSuffix=downloadNotePrefixAndSuffix[1],pageBackgroundColor=document.getElementById("pageBackgroundColor"),pageSetupStyle=document.getElementById("pageSetupStyle"),pageTextColor=document.getElementById("pageTextColor"),
pdfFileInput=document.getElementById("pdfFileInput"),pdfView=document.getElementById("pdfView"),pdfViewer=document.getElementById("pdfViewer"),resetTypingTarget=document.getElementById("resetTypingTarget"),revertToDefaultStyle=document.getElementById("revertToDefaultStyle"),savedForLater=document.getElementById("savedForLater"),savedForLaterDetails=document.getElementById("savedForLaterDetails"),setTypingTarget=document.getElementById("setTypingTarget"),shareCopyLink=document.getElementById("shareCopyLink"),
snackbar=document.getElementById("snackbar"),snackbarMessage=document.getElementById("snackbarMessage"),symbolsDisplay=document.getElementById("symbolsDisplay"),tableColumns=document.getElementById("tableColumns"),tableRows=document.getElementById("tableRows"),textFileInput=document.getElementById("textFileInput"),textView=document.getElementById("textView"),textViewActions=document.getElementById("textViewActions"),textViewer=document.getElementById("textViewer"),textViewFont=document.getElementById("textViewFont"),
totalWordCountDisplay=document.getElementById("totalWordCountDisplay"),tubeVideoView=document.getElementById("tubeVideoView"),tubeVideoViewer=document.getElementById("tubeVideoViewer"),typingTarget=document.getElementById("typingTarget"),uncheckedImageSource="Assets/Images/menu_dropdown_placeholder.svg",URLToCloudFile=document.getElementById("URLToCloudFile"),URLToOnlineDesign=document.getElementById("URLToOnlineDesign"),URLToPDFInput=document.getElementById("URLToPDFInput"),URLToTubeVideo=document.getElementById("URLToTubeVideo"),
userGreeting=document.getElementById("userGreeting"),videoFileInput=document.getElementById("videoFileInput"),videoView=document.getElementById("videoView"),videoViewer=document.getElementById("videoViewer"),viewersContainer=document.getElementById("viewersContainer"),viewerStatusBar=document.getElementById("viewerStatusBar"),viewingHistoryTable=document.getElementById("viewingHistoryTable"),viewingSize=document.getElementById("viewingSize"),webpageURLBar=document.getElementById("webpageURLBar"),
webpageView=document.getElementById("webpageView"),webpageViewer=document.getElementById("webpageViewer"),wordCount=document.getElementById("wordCount"),wordCountVisual=document.getElementById("wordCountVisual"),wordCountVisualMax=document.getElementById("wordCountVisualMax"),wordDocumentView=document.getElementById("wordDocumentView"),wordDocumentViewer=document.getElementById("wordDocumentViewer"),wordFileInput=document.getElementById("wordFileInput"),wordsOrCharacters=document.getElementById("wordsOrCharacters"),
wordWrap=document.getElementById("wordWrap"),wordWrapCheck=document.getElementById("wordWrapCheck"),workingURLParameters=new URLSearchParams(window.location.search);let addedCharacterCount=0,addedCharacterCountArray=[],addedWordCount=0,addedWordCountArray=[],codeFileViewFontSize=12,convertedFileOutput,isOpeningAnotherNote=!1,mainEditorFontSize=13,printTitle,textViewFontSize=14;
